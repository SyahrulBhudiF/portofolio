---
import { getCollection } from "astro:content";
import Contact from "../Contact";
import ExperienceCard from "../ExperienceCard";
import MountainSVG from "../MountainSVG";

// Get work experiences from content collection
const workExperiencesRaw = await getCollection("experiences");
const workExperiences = workExperiencesRaw.sort((a, b) => a.data.order - b.data.order);

// Get education from content collection
const educationRaw = await getCollection("education");
const educationExperiences = educationRaw.sort((a, b) => a.data.order - b.data.order);
---

<section
    class="text-white bg-linear-to-b from-gray-700 to-gray-600 w-full h-full max-xl:h-fit max-lg:pb-24 flex flex-col items-center justify-between relative pb-20 px-16 max-md:px-8"
    id="experience"
>
    <h2 class="text-retro text-6xl text-center max-sm:text-5xl mb-8">
        Experience
    </h2>
    <div
        class="w-full 2xl:w-3/4 z-20 mt-10 grid grid-cols-2 max-lg:grid-cols-1 gap-4"
    >
        <div class="mb-12">
            <h3
                class="text-3xl font-bold text-purple-300 max-sm:text-2xl mb-6 text-center"
            >
                Work
            </h3>
            <div class="flex flex-col gap-4">
                {
                    workExperiences.map((experience) => (
                        <ExperienceCard
                            title={experience.data.company}
                            subtitle={experience.data.position}
                            duration={experience.data.duration}
                            location={experience.data.location}
                            description={experience.data.description}
                            tags={experience.data.tags}
                            skills={experience.data.technologies}
                            client:idle
                        />
                    ))
                }
            </div>
        </div>

        <div class="mb-12">
            <h3
                class="text-3xl font-bold text-purple-300 max-sm:text-2xl mb-6 text-center"
            >
                Education
            </h3>
            <div class="flex flex-col gap-4">
                {
                    educationExperiences.map((education) => (
                        <ExperienceCard
                            title={education.data.institution}
                            subtitle={education.data.degree}
                            duration={education.data.duration}
                            location={education.data.location}
                            description={education.data.description}
                            tags={education.data.tags}
                            skills={education.data.achievements}
                            client:idle
                        />
                    ))
                }
            </div>
        </div>
    </div>

    <div class="flex flex-col gap-2 z-20 mt-26 max-xl:mt-30 justify-center">
        <h2 class="text-retro text-6xl text-center max-sm:text-5xl">
            Want to Collaborate?
        </h2>
        <p class="text-lg text-white/80 text-center mt-4 max-sm:text-base">
            Let's Have a Chat
        </p>
        <p class="text-base text-white/70 text-center max-sm:text-sm">
            Feel free to reach out to me if you have any questions, want to
            collaborate on a project, or just want to chat. I'm always open to
            new opportunities and connections.
        </p>
    </div>

    <div class="w-full max-w-lg mt-4 z-20">
        <Contact />
    </div>
    <MountainSVG client:visible />
</section>
